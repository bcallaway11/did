<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Aggregate Group-Time Average Treatment Effects — aggte • did</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate Group-Time Average Treatment Effects — aggte"><meta property="og:description" content='A function to take group-time average treatment effects
and aggregate them into a smaller number of parameters.  There are
several possible aggregations including "simple", "dynamic", "group",
and "calendar."'><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">did</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/index.html">User Guides</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bcallaway11/did/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Aggregate Group-Time Average Treatment Effects</h1>
    <small class="dont-index">Source: <a href="https://github.com/bcallaway11/did/blob/HEAD/R/aggte.R" class="external-link"><code>R/aggte.R</code></a></small>
    <div class="hidden name"><code>aggte.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A function to take group-time average treatment effects
and aggregate them into a smaller number of parameters.  There are
several possible aggregations including "simple", "dynamic", "group",
and "calendar."</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aggte</span><span class="op">(</span></span>
<span>  <span class="va">MP</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  balance_e <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_e <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  max_e <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bstrap <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  biters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cband <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clustervars <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>MP</dt>
<dd><p>an MP object (i.e., the results of the <code><a href="att_gt.html">att_gt()</a></code> method)</p></dd>


<dt>type</dt>
<dd><p>Which type of aggregated treatment effect parameter to compute.
One option is "simple" (this just computes a weighted average of all
group-time average treatment effects with weights proportional to group
size).  Other options are "dynamic" (this computes average effects across
different lengths of exposure to the treatment and is similar to an
"event study"; here the overall effect averages the effect of the
treatment across all positive lengths of exposure); "group" (this
is the default option and
computes average treatment effects across different groups; here
the overall effect averages the effect across different groups); and
"calendar" (this computes average treatment effects across different
time periods; here the overall effect averages the effect across each
time period).</p></dd>


<dt>balance_e</dt>
<dd><p>If set (and if one computes dynamic effects), it balances
the sample with respect to event time.  For example, if <code>balance.e=2</code>,
<code>aggte</code> will drop groups that are not exposed to treatment for
at least three periods. (the initial period when <code>e=0</code> as well as the
next two periods when <code>e=1</code> and the <code>e=2</code>).  This ensures that
the composition of groups does not change when event time changes.</p></dd>


<dt>min_e</dt>
<dd><p>For event studies, this is the smallest event time to compute
dynamic effects for.  By default, <code>min_e = -Inf</code> so that effects at
all lengths of exposure are computed.</p></dd>


<dt>max_e</dt>
<dd><p>For event studies, this is the largest event time to compute
dynamic effects for.  By default, <code>max_e = Inf</code> so that effects at
all lengths of exposure are computed.</p></dd>


<dt>na.rm</dt>
<dd><p>Logical value if we are to remove missing Values from analyses. Defaults is FALSE.</p></dd>


<dt>bstrap</dt>
<dd><p>Boolean for whether or not to compute standard errors using
the multiplier bootstrap.  If standard errors are clustered, then one
must set <code>bstrap=TRUE</code>. Default is value set in the MP object.  If bstrap is <code>FALSE</code>, then analytical
standard errors are reported.</p></dd>


<dt>biters</dt>
<dd><p>The number of bootstrap iterations to use.  The default is the value set in the MP object,
and this is only applicable if <code>bstrap=TRUE</code>.</p></dd>


<dt>cband</dt>
<dd><p>Boolean for whether or not to compute a uniform confidence
band that covers all of the group-time average treatment effects
with fixed probability <code>1-alp</code>.  In order to compute uniform confidence
bands, <code>bstrap</code> must also be set to <code>TRUE</code>.  The default is
the value set in the MP object</p></dd>


<dt>alp</dt>
<dd><p>the significance level, default is value set in the MP object.</p></dd>


<dt>clustervars</dt>
<dd><p>A vector of variables to cluster on.  At most, there
can be two variables (otherwise will throw an error) and one of these
must be the same as idname which allows for clustering at the individual
level. Default is the variables set in the MP object</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An <code><a href="AGGTEobj.html">AGGTEobj</a></code> object that holds the results from the
aggregation</p>
    </div>
    <div id="examples">
    <h2>Examples</h2>
    


<p>Initial ATT(g,t) estimates from <code><a href="att_gt.html">att_gt()</a></code></p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mpdta</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/att_gt.html">att_gt</a></span><span class="op">(</span>yname<span class="op">=</span><span class="st">"lemp"</span>,</span>
<span>               tname<span class="op">=</span><span class="st">"year"</span>,</span>
<span>               idname<span class="op">=</span><span class="st">"countyreal"</span>,</span>
<span>               gname<span class="op">=</span><span class="st">"first.treat"</span>,</span>
<span>               xformla<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>               data<span class="op">=</span><span class="va">mpdta</span><span class="op">)</span></span></code></pre><p></p></div>
<p>You can aggregate the ATT(g,t) in many ways.</p>
<p><strong>Overall ATT:</strong></p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/aggte.html">aggte</a></span><span class="op">(</span><span class="va">out</span>, type <span class="op">=</span> <span class="st">"simple"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; aggte(MP = out, type = "simple")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    ATT    Std. Error     [ 95%  Conf. Int.]  </span></span>
<span><span class="co">#&gt;  -0.04        0.0121    -0.0636     -0.0163 *</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: `*' confidence band does not cover 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Control Group:  Never Treated,  Anticipation Periods:  0</span></span>
<span><span class="co">#&gt; Estimation Method:  Doubly Robust</span></span></code></pre><p></p></div>
<p><strong>Dynamic ATT (Event-Study):</strong></p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/aggte.html">aggte</a></span><span class="op">(</span><span class="va">out</span>, type <span class="op">=</span> <span class="st">"dynamic"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; aggte(MP = out, type = "dynamic")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overall summary of ATT's based on event-study/dynamic aggregation:  </span></span>
<span><span class="co">#&gt;      ATT    Std. Error     [ 95%  Conf. Int.]  </span></span>
<span><span class="co">#&gt;  -0.0772        0.0208    -0.1181     -0.0364 *</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dynamic Effects:</span></span>
<span><span class="co">#&gt;  Event time Estimate Std. Error [95% Simult.  Conf. Band]  </span></span>
<span><span class="co">#&gt;          -3   0.0305     0.0139       -0.0045      0.0655  </span></span>
<span><span class="co">#&gt;          -2  -0.0006     0.0129       -0.0330      0.0319  </span></span>
<span><span class="co">#&gt;          -1  -0.0245     0.0144       -0.0607      0.0118  </span></span>
<span><span class="co">#&gt;           0  -0.0199     0.0127       -0.0519      0.0120  </span></span>
<span><span class="co">#&gt;           1  -0.0510     0.0162       -0.0917     -0.0102 *</span></span>
<span><span class="co">#&gt;           2  -0.1373     0.0369       -0.2300     -0.0445 *</span></span>
<span><span class="co">#&gt;           3  -0.1008     0.0384       -0.1975     -0.0041 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: `*' confidence band does not cover 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Control Group:  Never Treated,  Anticipation Periods:  0</span></span>
<span><span class="co">#&gt; Estimation Method:  Doubly Robust</span></span></code></pre><p></p></div>
<p><strong>ATT for each group:</strong></p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/aggte.html">aggte</a></span><span class="op">(</span><span class="va">out</span>, type <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; aggte(MP = out, type = "group")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overall summary of ATT's based on group/cohort aggregation:  </span></span>
<span><span class="co">#&gt;     ATT    Std. Error     [ 95%  Conf. Int.]  </span></span>
<span><span class="co">#&gt;  -0.031        0.0124    -0.0552     -0.0068 *</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group Effects:</span></span>
<span><span class="co">#&gt;  Group Estimate Std. Error [95% Simult.  Conf. Band]  </span></span>
<span><span class="co">#&gt;   2004  -0.0797     0.0293       -0.1474     -0.0121 *</span></span>
<span><span class="co">#&gt;   2006  -0.0229     0.0174       -0.0631      0.0172  </span></span>
<span><span class="co">#&gt;   2007  -0.0261     0.0171       -0.0654      0.0133  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: `*' confidence band does not cover 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Control Group:  Never Treated,  Anticipation Periods:  0</span></span>
<span><span class="co">#&gt; Estimation Method:  Doubly Robust</span></span></code></pre><p></p></div>
<p><strong>ATT for each calendar year:</strong></p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/aggte.html">aggte</a></span><span class="op">(</span><span class="va">out</span>, type <span class="op">=</span> <span class="st">"calendar"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; aggte(MP = out, type = "calendar")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reference: Callaway, Brantly and Pedro H.C. Sant'Anna.  "Difference-in-Differences with Multiple Time Periods." Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overall summary of ATT's based on calendar time aggregation:  </span></span>
<span><span class="co">#&gt;      ATT    Std. Error     [ 95%  Conf. Int.]  </span></span>
<span><span class="co">#&gt;  -0.0417        0.0164    -0.0738     -0.0096 *</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Time Effects:</span></span>
<span><span class="co">#&gt;  Time Estimate Std. Error [95% Simult.  Conf. Band]  </span></span>
<span><span class="co">#&gt;  2004  -0.0105     0.0248       -0.0685      0.0475  </span></span>
<span><span class="co">#&gt;  2005  -0.0704     0.0318       -0.1448      0.0039  </span></span>
<span><span class="co">#&gt;  2006  -0.0488     0.0200       -0.0956     -0.0021 *</span></span>
<span><span class="co">#&gt;  2007  -0.0371     0.0134       -0.0684     -0.0057 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: `*' confidence band does not cover 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Control Group:  Never Treated,  Anticipation Periods:  0</span></span>
<span><span class="co">#&gt; Estimation Method:  Doubly Robust</span></span></code></pre><p></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://bcallaway11.github.io/" class="external-link">Brantly Callaway</a>, <a href="https://pedrohcgs.github.io/" class="external-link">Pedro H. C. Sant’Anna</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

